MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; ------------------------------------------------------------------------      ;
                      00002 ; TITLE: Exam demonstration of A/D converter and I2C use on a PicDem board      ;
                      00003 ;                                                                                                       
                                                                            ;
                      00004 ; Candidate:    Daniele Costarella                                                                      
                                            ;
                      00005 ; ID:                   884/000376                                                                      
                                                            ;
                      00006 ; ------------------------------------------------------------------------      ;
                      00007 ;                                                                                                       
                                                                            ;
                      00008 ; Filename:             main.asm                                                                        
                                                            ;
                      00009 ; Revision:             1.0.4                                                                           
                                                            ;
                      00010 ; Date:                                                                                                 
                                                                    ;
                      00011 ;                                                                                                       
                                                                            ;
                      00012 ; System files required:                                                                                
                                                    ;
                      00013 ;                               lcdctrl.asm                                                             
                                                                    ;
                      00014 ;                               commons.asm                                                             
                                                            ;
                      00015 ;                               P16F877A.inc                                                            
                                                            ;
                      00016 ;                               16F877A.lkr                                                             
                                                                    ;
                      00017 ; ------------------------------------------------------------------------      ;
                      00018 
                      00019 ; ***************************************************************************
                      00020 ; *                                                                                                     
                                                                    *
                      00021 ; *     Part used = PIC16F877a on a PicDem clone                                                        
                                    *
                      00022 ; * [for information about PicDem visit http://www.microchip.com]                       *
                      00023 ; *                                                                                                     
                                                                            *
                      00024 ; * Note: All timings are based on a reference crystal frequency of 4Mhz        *
                      00025 ; * which is equivalent to an instruction of 1us                                                        
                            *
                      00026 ; *                                                                                                     
                                                                            *
                      00027 ; ***************************************************************************
                      00028  
                      00029 
                      00030                 list            p=16f877a
                      00031                 #include        P16f877A.INC
                      00001         LIST
                      00002 ; P16F877A.INC  Standard Header File, Version 1.00    Microchip Technology, Inc.
                      00400         LIST
                      00032                 radix           dec
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00033                 ErrorLevel      -302
2007   3D31           00034         __CONFIG   h'3D31'                                      ; with Power On Reset old_value
                      00035 
                      00036 ; ------------------------------------------------------------------------ ;
                      00037 ; Config register bits
                      00038 ; CP1 CP0 DBG NIL WRT CPD LVP BOR CP1 CP0   WDT OS1 OS0
                      00039 ;  1   1   1   1   0   1   0   0   1   1   0   0   0   1
                      00040 ; ------------------------------------------------------------------------ ;
                      00041 
                      00042 
  0000                00043                 extern          delayLoop, wait
  0000                00044                 extern          lcdInit, lcdWrite, waitBusyFlag, setXAddress
  0000                00045                 extern          printString
  0000                00046                 extern          return2home     ; non usata
  0000                00047                 extern          hex2ascii, lcdClear, lcdRxShift
  0000                00048                 extern          mul13x10
                      00049 
                      00050          
                      00051 ;***** VARIABLE DEFINITIONS *****
                      00052  
                      00053 SHARED                          UDATA_SHR   
0000                  00054 w_temp                          RES                     1                               ; variable used 
                            for context saving 
0001                  00055 stat_temp                       RES                     1                               ; variable used 
                            for context saving
                      00056  
                      00057  
                      00058 RAM0                            UDATA                           ; explicit address specified is not requ
                            ired
0000                  00059 count                           RES                     1               ; temporary variable (example)
                      00060  
  000000F2            00061 index                           EQU                     242             ; init count var
  0000000F            00062 delayCount                      EQU                     15
                      00063 ;BITTEST                        EQU                     H'01'
0001                  00064 char                            RES                     1               ; char to print
0002                  00065 point2Char                      RES                     1
0003                  00066 temp3                           RES                     1               ; non usata
                      00067 
0004                  00068 binvalue                        RES                     3               ; binary value to convert to bcd
0007                  00069 untten                          RES                     1
0008                  00070 hdrthd                          RES                     1
0009                  00071 tensOfThousands         RES                     1               ;tensOfThousands
000A                  00072 milions                         RES                     1
                      00073 
000B                  00074 temp                            RES                     3               ; utilizzata per la moltiplicazi
                            one
000E                  00075 cmd_byte                        RES             1
000F                  00076 mode                            RES                     1               ; selected mode (voltmeter or th
                            ermometer)
                      00077                                                                                 ; 00000001 => main menu
                      00078                                                                                 ; 00000010 => voltmeter
                      00079                                                                                 ; 00000100 => thermomete
                            r
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00080 
                      00081 ; daa function
0010                  00082 num1            RES     2
0012                  00083 num2            RES 2
0014                  00084 adjflag         RES     1
0015                  00085 sum                     RES     2
0017                  00086 number          RES 1
                      00087 ;floatingValues         RES                     7               ; utilizzati per l'arrotondamento
                      00088 
                      00089  
                      00090  
                      00091 ; example of using Overlayed Uninitialized Data Section
                      00092 G_DATA                          UDATA_OVR                       ; explicit address can be specified
0000                  00093 flag                            RES                     2               ; temporary variable (shared loc
                            ations - G_DATA)
                      00094  
                      00095 G_DATA                          UDATA_OVR   
0000                  00096 count1                          RES                     1               ; temporary variable (shared loc
                            ations - G_DATA)
0001                  00097 var                                     RES                     1
                      00098 ;temp                           RES                     1
                      00099 
0002                  00100 var2                            RES                     2
0004                  00101 resconv                         RES                     2               ; resconv è il risultato di hexc
                            onv
0006                  00102 SW_STATUS                       RES                     1               ; register status of switch ****
                            **11 or 00 (pushed)
                      00103 
                      00104 
                      00105 
                      00106 
                      00107 #DEFINE                         EN                      6
                      00108 
                      00109 ; sw1 and sw2 are the switches on the demo board
  00000000            00110 SW1                                     EQU                     0               ; RB0
  00000004            00111 SW2                                     EQU                     4               ; RA4
                      00112 
  0000009B            00113 TC74ADD_R                       EQU                     10011011B               ;TC74 address (read)
  0000009A            00114 TC74ADD_W                       EQU                     10011010B               ;TC74 address (write)
                      00115                                 
                      00116 
                      00117 
                      00118 ;**********************************************************************
                      00119 STARTUP CODE                                                                    ; processor reset vector
0000   30??           00120          movlw   high start                                             ; load upper byte of 'start' lab
                            el
0001   008A           00121          movwf   PCLATH                                                 ; initialize PCLATH
0002   2???           00122          goto    start                                                  ; go to beginning of program
                      00123  
                      00124  
                      00125 INTVECT CODE                                                                    ; interrupt vector locat
                            ion
0000   00??           00126                 movwf   w_temp                                                  ; save off current W reg
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ister contents
0001   0803           00127                 movf    STATUS,w                                                ; move status register i
                            nto W register
0002   00??           00128                 movwf   stat_temp                                               ; save off contents of S
                            TATUS register 
                      00129 
0003   1283 1303      00130                 banksel PIR1
0005   100C           00131                 bcf             PIR1, TMR1IF
                      00132 
0006   ???? ????      00133                 banksel count
0008   0B??           00134                 decfsz  count, f
0009   2???           00135                 goto    skipShifts
000A   300B           00136                 movlw   27-16
000B   ???? ????      00137                 banksel count
000D   00??           00138                 movwf   count
000E                  00139 indietro
000E   2???           00140                 call    lcdRxShift
000F   0B??           00141                 decfsz  count, f
0010   2???           00142                 goto    indietro
0011   ???? ????      00143                 banksel count
0013   3045           00144                 movlw   53+16
0014   00??           00145                 movwf   count
                      00146                 
0015                  00147 skipShifts
0015   2???           00148                 call    lcdRxShift
                      00149 
                      00150                 
                      00151 
0016   1283 1303      00152                 banksel TMR1H
0018   30DF           00153                 movlw   0xDF
0019   008F           00154                 movwf   TMR1H
001A   30FF           00155                 movlw   0xFF
                      00156 
                      00157                 ; ritorno dall'interrupt
001B   08??           00158                 movf    stat_temp,w                                             ; retrieve copy of STATU
                            S register
001C   0083           00159                 movwf   STATUS                                                  ; restore pre-isr STATUS
                             register contents
001D   0E??           00160                 swapf   w_temp,f
001E   0E??           00161                 swapf   w_temp,w                                                ; restore pre-isr W regi
                            ster contents
001F   0009           00162                 retfie                                                                  ; return from in
                            terrupt
                      00163                                                                                                 ; put GI
                            E bit up again
                      00164  
                      00165 
                      00166 
0020   3448 3465 346C 00167 text1 DT "Hello PIC!", 0
       346C 346F 3420 
       3450 3449 3443 
       3421 3400 
002B   3444 3461 3474 00168 text2 DT "Data received", 0
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       3461 3420 3472 
       3465 3463 3465 
       3469 3476 3465 
       3464 3400 
0039   3453 3465 346C 00169 text6 DT "Select function >>> 1: Voltmeter *** 2: Thermometer", 0
       3465 3463 3474 
       3420 3466 3475 
       346E 3463 3474 
       3469 346F 346E 
       3420 343E 343E 
       343E 3420 3431 
       343A 3420 3456 
       346F 346C 3474 
       346D 3465 3474 
       3465 3472 3420 
       342A 342A 342A 
       3420 3432 343A 
       3420 3454 3468 
       3465 3472 346D 
       346F 346D 3465 
       3474 346
                      00170 
006D   3453 3465 346C 00171 textMenu1       DT      "Select function"
       3465 3463 3474 
       3420 3466 3475 
       346E 3463 3474 
       3469 346F 346E 
Warning[209]: Missing quote
007C   3431 342E      00172 textMenu2       DT      "1.
                      00173 
                      00174 
                      00175 ; -------------------------------------------------------------------------     ;
                      00176 ;      *****************  MAIN CODE START LOCATION  *****************           ;
                      00177 ; -------------------------------------------------------------------------     ;
                      00178 MAIN    CODE
0000                  00179 start
                      00180                 ; init TIMER1
0000   0190           00181                 clrf     T1CON                                          ; Stop Timer1, Internal Clock So
                            urce,
                      00182                                                                                         ; T1 oscillator 
                            disabled, prescaler = 1:1
                      00183                 ;banksel        TMR1H
0001   018F           00184                 clrf    TMR1H
0002   018E           00185                 clrf    TMR1L
                      00186 
0003   018B           00187                 clrf    INTCON
                      00188 
0004   1683           00189                 bsf     STATUS, RP0                             ; Bank1
0005   018C           00190                 clrf    PIE1                                            ; Disable peripheral interrupts
0006   140C           00191                 bsf             PIE1, TMR1IE
                      00192 
0007   1283           00193                 bcf     STATUS, RP0                             ; Bank0
0008   018C           00194                 clrf    PIR1                                            ; Clear peripheral interrupts Fl
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ags
                      00195 
0009   1283 1303      00196                 banksel T1CON
000B   300A           00197                 movlw   00001010B                                       ; Set Prescaler to 1
000C   0090           00198                 movwf   T1CON
                      00199 
000D   1410           00200                 bsf T1CON, TMR1ON                                       ; Timer1 starts to increment
                      00201         
                      00202 ; ------------------------------------------------------------------------- ;
                      00203 ;      Display A/D Converter and I2C init routine calls                                                 
                            ;
                      00204 ; ------------------------------------------------------------------------- ;
000E   2???           00205                 call    lcdInit                                         ; call Display Init SubRoutine
000F   2???           00206                 call    convInit                                        ; A/D converter initialization
0010   2???           00207                 call    wait
                      00208                 
0011   2???           00209                 call    tc74Init                                        ; tc74 AND I2C INIT
0012   2???           00210                 call    i2cIdle
0013   2???           00211                 call    tc74StandBy                                     ; put TC74 in StandBy mode (I < 
                            5uA)
                      00212 
0014   2???           00213                 call    lcdClear
0015   2???           00214                 call    wait
                      00215                 
0016   1683           00216                 bsf             STATUS, RP0
0017   0806           00217                 movfw   TRISB
0018   3801           00218                 iorlw   000000001B
0019   0086           00219                 movwf   TRISB
                      00220 
001A   0805           00221                 movfw   TRISA
001B   3810           00222                 iorlw   00010000B
001C   0085           00223                 movwf   TRISA
001D   1283           00224                 bcf             STATUS, RP0                                     ; return to Bank0
                      00225 
                      00226 
001E                  00227 menu
001E   2???           00228                 call    lcdClear
001F   3000           00229                 movlw   0
0020   2???           00230                 call    setXAddress
0021   30??           00231                 movlw   text6
0022   2???           00232                 call    printString
0023   3035           00233                 movlw   53                                                      ; welcome string chars n
                            umber (for scroll)
0024   ???? ????      00234                 banksel count
0026   00??           00235                 movwf   count
                      00236                 
0027   018C           00237                 clrf    PIR1                                            ; clear Peripheral Interrupt Fla
                            g register (PIR1)
                      00238 
0028   1283 1303      00239                 banksel INTCON
002A   30C0           00240                 movlw   11000000B                                       ; GIE and PEIE up (turn interrup
                            t on RP port off)
002B   008B           00241                 movwf   INTCON
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00242 
                      00243 ; ------------------------------------------------------------------------ ;
                      00244 ;      *****************   MAIN LOOP BEGINS HERE   *****************       ;
                      00245 ; ------------------------------------------------------------------------ ;            
002C                  00246 mainLoop
002C   0000           00247                 nop
002D   ???? ????      00248                 banksel mode
002F   01??           00249                 clrf    mode
                      00250 
0030   ???? ????      00251                 banksel mode
0032   1C06           00252                 btfss   PORTB, SW1
0033   1480           00253                 bsf             mode, 1                                         ; usage as voltmeter
                      00254 
0034   1E05           00255                 btfss   PORTA, SW2
0035   1500           00256                 bsf             mode, 2                                         ; usage as thermometer
                      00257 
0036   1880           00258                 btfsc   mode, 1
0037   2???           00259                 call    voltmeter
                      00260 
0038   1900           00261                 btfsc   mode, 2
0039   2???           00262                 call    thermometer
                      00263 
003A   2???           00264                 goto    mainLoop
                      00265                 
                      00266 
                      00267 
                      00268 ; -------------------------------------------------------------------------     ;
                      00269 ;        ********************** THERMOMETER  **********************                     ;
                      00270 ; -------------------------------------------------------------------------     ;
                      00271 
003B                  00272 thermometer
003B   0000           00273                 nop
003C   130B           00274                 bcf             INTCON, PEIE                            ; all pheripheral interrupts dis
                            abled
                      00275 
003D   2???           00276                 call    lcdClear
                      00277 
003E   1100           00278                 bcf             mode, 2                                         ; drop to zero thermomet
                            er bit mode
                      00279 
003F   3005           00280                 movlw   5
0040   2???           00281                 call    setXAddress
0041   30DF           00282                 movlw   11011111B
0042   2???           00283                 call    lcdWrite
                      00284 
0043   3043           00285                 movlw   'C'
0044   2???           00286                 call    lcdWrite
0045   3000           00287                 movlw   0
0046   2???           00288                 call    setXAddress
                      00289                 
                      00290                 
0047   2???           00291                 call    i2cIdle
0048   1411           00292                 bsf             SSPCON2, SEN                            ; start condition enable bit    
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0049   1811           00293                 btfsc   SSPCON2, SEN
004A   2???           00294                 goto    $-1
                      00295 
004B   2???           00296                 call    i2cIdle                         
004C   1283 1303      00297                 banksel SSPBUF
004E   309A           00298                 movlw   TC74ADD_W                                       ; TC74 address (default) <6:0> (
                            write)
004F   0093           00299                 movwf   SSPBUF
0050   2???           00300                 call    waitAck
                      00301                 
0051   2???           00302                 call    i2cIdle 
0052   1283 1303      00303                 banksel SSPBUF
0054   3001           00304                 movlw   0x01                                            ;TC74 r/w config command byte
0055   0093           00305                 movwf   SSPBUF
0056   2???           00306                 call    waitAck
                      00307 
0057   2???           00308                 call    i2cIdle                 
0058   3000           00309                 movlw   0x00                                            ; Write 0x00 to DATA config regi
                            ster
0059   1283 1303      00310                 banksel SSPBUF
005B   0093           00311                 movwf   SSPBUF
005C   2???           00312                 call    waitAck
                      00313 
005D   2???           00314                 call    i2cIdle
005E   1683 1303      00315                 banksel SSPCON2
0060   1511           00316                 bsf             SSPCON2, PEN
0061   1911           00317                 btfsc   SSPCON2, PEN
0062   2???           00318                 goto    $-1
                      00319                 
                      00320                 ;call   i2cIdle
0063   1683 1303      00321                 banksel SSPCON2
0065   1411           00322                 bsf             SSPCON2, SEN
0066   1811           00323                 btfsc   SSPCON2, SEN
0067   2???           00324                 goto    $-1
                      00325         
                      00326                 ; TEMP register addressing      
0068   309A           00327                 movlw   TC74ADD_W
0069   1283 1303      00328                 banksel SSPBUF
006B   0093           00329                 movwf   SSPBUF
006C   2???           00330                 call    waitAck
                      00331                 
006D   2???           00332                 call    i2cIdle
006E   1283 1303      00333                 banksel SSPBUF
0070   3000           00334                 movlw   0x00
0071   0093           00335                 movwf   SSPBUF                                                  ; addressing TEMP
0072   2???           00336                 call    waitAck
                      00337 
                      00338                 
0073                  00339 getTemp 
0073   2???           00340                 call    i2cIdle
0074   1683 1303      00341                 banksel SSPCON2 
0076   1491           00342                 bsf             SSPCON2, RSEN
0077   1891           00343                 btfsc   SSPCON2, RSEN
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0078   2???           00344                 goto    $-1
                      00345                         
0079   309B           00346                 movlw   TC74ADD_R                                               ; TC74 address in read m
                            ode
007A   1283 1303      00347                 banksel SSPBUF  
007C   0093           00348                 movwf   SSPBUF
007D   2???           00349                 call    waitAck
                      00350                 
007E   2???           00351                 call    i2cIdle
007F   2???           00352                 call    readByte
0080   1283 1303      00353                 banksel SSPBUF
0082   0813           00354                 movfw   SSPBUF  
                      00355                 ; at this point read value is in W
                      00356                 
                      00357 
                      00358                 ; check Button Status
0083   ???? ????      00359                 banksel mode
0085   1C06           00360                 btfss   PORTB, SW1
0086   1480           00361                 bsf             mode, 1
                      00362 
0087   1880           00363                 btfsc   mode, 1
0088   2???           00364                 call    sw2voltmeter                                    ; call voltmeter routine
                      00365         
0089   2???           00366                 call    convert_temp
                      00367 
                      00368 
008A                  00369 convert_temp
008A   ???? ????      00370                 banksel binvalue
008C   01??           00371                 clrf    binvalue
008D   01??           00372                 clrf    binvalue+1
008E   00??           00373                 movwf   binvalue+2
                      00374 
                      00375                 ; tests
                      00376                 ;movlw  10111111B
                      00377                 ;movlw  00000000B
                      00378                 ;movlw  01111111B
                      00379                 ;movlw  -11
                      00380                 
008F   302D           00381                 movlw   "-"
0090   1F80           00382                 btfss   binvalue+2, 7
0091   302B           00383                 movlw   "+"
0092   2???           00384                 call    lcdWrite
                      00385 
0093   1B80           00386                 btfsc   binvalue+2, 7                                           ; is value negative?
0094   2???           00387                 call    twoComplement                                           ; 2's complement convers
                            ion
                      00388 
0095   2???           00389                 call    bin2bcd
                      00390                 
0096   08??           00391                 movfw   hdrthd
0097   3800           00392                 iorlw   0
0098   3020           00393                 movlw   " "                                                                     ; if val
                            ue is zero
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0099   1903           00394                 btfsc   STATUS, Z
009A   2???           00395                 goto    hundreds
                      00396                 
009B   08??           00397                 movfw   hdrthd
009C   390F           00398                 andlw   00001111B
009D   3E30           00399                 addlw   48
009E                  00400 hundreds
009E   2???           00401                 call    lcdWrite
                      00402 
009F   08??           00403                 movfw   untten
00A0   39F0           00404                 andlw   11110000B
00A1   3800           00405                 iorlw   0
00A2   3020           00406                 movlw   " "                                                                     ; if val
                            ue is zero
00A3   1903           00407                 btfsc   STATUS, Z
00A4   2???           00408                 goto    tensAndUnits
                      00409 
00A5   08??           00410                 movfw   untten
00A6   0E??           00411                 swapf   untten, W
00A7   390F           00412                 andlw   00001111B
00A8   3E30           00413                 addlw   48
00A9                  00414 tensAndUnits
00A9   2???           00415                 call    lcdWrite
                      00416 
00AA   08??           00417                 movfw   untten
00AB   390F           00418                 andlw   00001111B
00AC   3E30           00419                 addlw   48
00AD   2???           00420                 call    lcdWrite
00AE   3000           00421                         movlw   0
00AF   2???           00422                 call    setXAddress
00B0   2???           00423                 goto    getTemp         
                      00424 
                      00425 ; The binary value is in 2’s complement format so it needs to be converted
                      00426 ; twoComplement writes the correct value in binvalue+2
00B1                  00427 twoComplement                           
                      00428                 ;movlw  "-"
                      00429                 ;call   lcdWrite
00B1   09??           00430                 comf    binvalue+2, f
00B2   0A??           00431                 incf    binvalue+2, f
00B3   0008           00432                 return
                      00433 
                      00434 
00B4                  00435 waitAck
                      00436                 ;call   i2cIdle
00B4   0000           00437                 nop
00B5   1683 1303      00438                 banksel SSPCON2
00B7   1B11           00439                 btfsc   SSPCON2, ACKSTAT
00B8   2???           00440                 goto    $-1                                                             ; ACKSTAT will b
                            e cleared by hardware
00B9   2???           00441                 call    delayLoop
00BA   0008           00442                 return
                      00443 
00BB                  00444 readByte                                                                                ; read by TEMP r
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            egister
00BB   0000           00445                 nop
00BC   1683 1303      00446                 banksel SSPSTAT
00BE   1014           00447                 bcf             SSPSTAT, BF
                      00448 
00BF   2???           00449                 call    i2cIdle
00C0   1683 1303      00450                 banksel SSPCON2
00C2   1591           00451                 bsf             SSPCON2, RCEN                                   ; enable receive mode
                      00452 
00C3   1991           00453                 btfsc   SSPCON2, RCEN
00C4   2???           00454                 goto $-1
                      00455 
00C5   1683 1303      00456                 banksel SSPSTAT
00C7   1C14           00457                 btfss   SSPSTAT, BF
00C8   2???           00458                 goto    $-1
                      00459 
                      00460                 ;btfss  SSPSTAT, BF                                             ; check if buffer full
                      00461                 ;goto   readByte
                      00462                 ;movfw  SSPBUF
                      00463 
                      00464                 ; send ack from master
00C9   1683 1303      00465                 banksel SSPCON2
00CB   1691           00466                 bsf             SSPCON2, ACKDT                                  ; preset the NACK bit
00CC   1611           00467                 bsf             SSPCON2, ACKEN                                  ; Initiate Acknowledge s
                            equence
00CD   1A11           00468                 btfsc   SSPCON2,ACKEN
00CE   2???           00469                 goto    $-1
                      00470 
00CF   0008           00471                 return
                      00472 
00D0                  00473 tc74Init
00D0   1683 1303      00474                 banksel TRISC
00D2   0807           00475                 movfw   TRISC                                                   ; set RC3, 4 as input   
                                    
00D3   3818           00476                 iorlw   00011000B
00D4   0087           00477                 movwf   TRISC
                      00478                 
                      00479                 ; SYNC SERIAL PORT CONTROL REGISTER config
00D5   1283 1303      00480                 banksel SSPCON
00D7   3028           00481                 movlw   00101000B
00D8   0094           00482                 movwf   SSPCON
                      00483 
00D9   1683 1303      00484                 banksel SSPSTAT
                      00485                 ;clrf   SSPSTAT
00DB   1794           00486                 bsf             SSPSTAT, SMP
                      00487 
                      00488                 
00DC   1683 1303      00489                 banksel SSPADD
00DE   3009           00490                 movlw   00001001B                                               ; setup 100Khz I2C clock
                      00491                                                                                                 ; SSPADD
                             = 9  Clock = fosc/(4(SSPADD+1))
                      00492                                                                                                 ; set Cl
                            ock freq to 100Khz
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00DF   0093           00493                 movwf   SSPADD                                                  ; Baud Rate Divisor gene
                            rator in Master Mode
                      00494 
00E0   0191           00495                 clrf    SSPCON2                                                 ; Clear control bits
00E1   0008           00496                 return
                      00497 
00E2                  00498 tc74StandBy                                                                             ; put tc74 in st
                            andby mode      
00E2   1683 1303      00499                 banksel SSPCON2 
00E4   1511           00500                 bsf             SSPCON2, PEN
00E5   1911           00501                 btfsc   SSPCON2, PEN
00E6   2???           00502                 goto    $-1
00E7   2???           00503                 call    i2cIdle
00E8                  00504 tcStandBy
00E8   1411           00505                 bsf             SSPCON2, SEN
00E9   1814           00506                 btfsc   SSPCON, SEN
00EA   2???           00507                 goto $-1
00EB   2???           00508                 call    i2cIdle
00EC   1283 1303      00509                 banksel SSPBUF
00EE   309A           00510                 movlw   TC74ADD_W                                               ; TC74 address (default)
                             <6:0> (write)
00EF   0093           00511                 movwf   SSPBUF
00F0   2???           00512                 call    waitAck
00F1   2???           00513                 call    i2cIdle 
00F2   1283 1303      00514                 banksel SSPBUF
00F4   3001           00515                 movlw   0x01                                                    ; TC74 r/w config comman
                            d byte
00F5   0093           00516                 movwf   SSPBUF
00F6   2???           00517                 call    waitAck
00F7   2???           00518                 call    i2cIdle                 
00F8   3080           00519                 movlw   0x80                                                    ; conf reg string for st
                            andby mode
00F9   1283 1303      00520                 banksel SSPBUF
00FB   0093           00521                 movwf   SSPBUF
00FC   2???           00522                 call    waitAck 
00FD   1683 1303      00523                 banksel SSPCON2 
00FF   1511           00524                 bsf             SSPCON2, PEN
0100   1911           00525                 btfsc   SSPCON2, PEN
0101   2???           00526                 goto    $-1
0102   0008           00527                 return
                      00528 
                      00529 ; IDLE module
0103                  00530 i2cIdle
0103   1683 1303      00531         banksel SSPSTAT
0105   1914           00532         btfsc   SSPSTAT, R_W
0106   2???           00533         goto    $-1
                      00534 
0107   1683 1303      00535         banksel SSPCON2
0109   0811           00536         movf    SSPCON2, W
010A   391F           00537         andlw   0x1f
010B   1D03           00538         btfss   STATUS, Z
010C   2???           00539         goto    $-3
010D   0008           00540         return
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00541 
                      00542 ; -------------------------------------------------------------------------     ;
                      00543 ;        **********************  VOLTMETER  **********************                      ;
                      00544 ; -------------------------------------------------------------------------     ;
                      00545 
                      00546 
010E                  00547 voltmeter
010E   0000           00548                 nop
010F   1283 1303      00549                 banksel INTCON
0111   130B           00550                 bcf             INTCON, PEIE                    ; all pheripheral interrupts disabled
0112   2???           00551                 call    lcdClear
                      00552 
0113                  00553 voltmeterInit
0113   ???? ????      00554                 banksel mode
0115   1080           00555                 bcf             mode, 1                                 ; drop to zero voltmeter bit mod
                            e
                      00556 
0116   3006           00557                 movlw   6
0117   2???           00558                 call    setXAddress
0118   3056           00559                 movlw   'V'
0119   2???           00560                 call    lcdWrite
                      00561                 
011A   3000           00562                 movlw   0                                               ; set display address to zero
011B   2???           00563                 call    setXAddress
011C   1283 1303      00564                 banksel ADCON0
011E   151F           00565                 bsf             ADCON0, GO_DONE                 ; start the conversion
011F                  00566 waitEOC                                                                 ; wait end of conversion        
                                    
011F   1D1F           00567                 btfss   ADCON0, GO_DONE
0120   2???           00568                 goto    waitEOC
                      00569 ;               
0121   2???           00570                 call    mul13x10
0122   0084           00571                 movwf   FSR                                             ; copy MSB address into FSR
0123   0800           00572                 movfw   INDF                                    ; load working with its content
0124   00??           00573                 movwf   temp
                      00574         
0125   0A84           00575                 incf    FSR, f
0126   0800           00576                 movfw   INDF
0127   00??           00577                 movwf   temp+1
                      00578         
0128   0A84           00579                 incf    FSR, f
0129   0800           00580                 movfw   INDF
012A   00??           00581                 movwf   temp+2
012B   0000           00582                 nop
                      00583 
                      00584                 ; copy temp to binvalue
012C   08??           00585                 movfw   temp
012D   00??           00586                 movwf   binvalue
012E   08??           00587                 movfw   temp+1
012F   00??           00588                 movwf   binvalue+1
0130   08??           00589                 movfw   temp+2
0131   00??           00590                 movwf   binvalue+2
                      00591 
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0132   2???           00592                 call    bin2bcd
                      00593 ; NUOVA FUNZIONE
                      00594 
0133   ???? ????      00595                 banksel num1
                      00596 
0135   01??           00597                 clrf    sum
0136   01??           00598                 clrf    sum+1
                      00599 
                      00600                 ; verifico se i 4 bit meno significati sono maggiori di 556 (BCD)
0137   08??           00601                 movfw   untten
0138   00??           00602                 movwf   num1+1
                      00603 
0139   08??           00604                 movfw   hdrthd
013A   390F           00605                 andlw   0x0F            ; mask for lsn
013B   00??           00606                 movwf   num1
                      00607 
                      00608                 ; carico il numero di test 444 (556+444= 1000 setterebbe a 1
                      00609                 ; il nibble più significatico
                      00610 
013C   3004           00611                 movlw   0x04
013D   00??           00612                 movwf   num2
013E   3044           00613                 movlw   0x44
013F   00??           00614                 movwf   num2+1
                      00615 
                      00616                 ; addiziono num1 a num2
0140   1003           00617                 bcf             STATUS, C
0141   07??           00618                 addwf   num1+1, W
                      00619                 
0142   00??           00620                 movwf   number
0143   2???           00621                 call    daa
                      00622                 
                      00623                 ; store ls bcd byte
0144   00??           00624                 movwf   sum+1
                      00625                 
0145   08??           00626                 movfw   num2
0146   1803           00627                 btfsc   STATUS, C
0147   3E01           00628                 addlw   1                                               ; Add one for carry
                      00629                 
0148   07??           00630                 addwf   num1, W                                 ; in W c'è num1 + (num2 + C)
                      00631                 
0149   00??           00632                 movwf   number
014A   2???           00633                 call    daa
                      00634 
014B   00??           00635                 movwf   sum
                      00636 
                      00637                 ; controllo il l'ms nibble di sum. Se 1 significa che
                      00638                 ; il risultato della somma è maggiore o uguale a 1000;
                      00639                 ; allora mi preparo per incrementare le restanti cifre
                      00640                 ; più significative
                      00641         
014C   1A00           00642                 btfsc   sum, 4
014D   2???           00643                 goto    rounding
                      00644 
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00645                 ; else, print as they like
                      00646                 ; (without rounding)
014E   08??           00647                 movfw   milions
014F   390F           00648                 andlw   00001111B
0150   3E30           00649                 addlw   48
0151   2???           00650                 call    lcdWrite
                      00651 
0152   302E           00652                 movlw   '.'
0153   2???           00653                 call    lcdWrite
                      00654 
0154   08??           00655                 movfw   tensOfThousands         
0155   0E??           00656                 swapf   tensOfThousands, W
0156   390F           00657                 andlw   00001111B
0157   3E30           00658                 addlw   48
0158   2???           00659                 call    lcdWrite
                      00660 
0159   08??           00661                 movfw   tensOfThousands         
015A   390F           00662                 andlw   00001111B
015B   3E30           00663                 addlw   48
015C   2???           00664                 call    lcdWrite
                      00665 
015D   08??           00666                 movfw   hdrthd
015E   0E??           00667                 swapf   hdrthd, W
015F   390F           00668                 andlw   00001111B
0160   3E30           00669                 addlw   48
0161   2???           00670                 call    lcdWrite
                      00671                 
                      00672                 
0162                  00673 checkButton2
                      00674                 ; check if sw2 is pushed; if it occurs switch to thermometer
0162   ???? ????      00675                 banksel mode
0164   1E05           00676                 btfss   PORTA, SW2
0165   1500           00677                 bsf             mode, 2
                      00678         
0166   1900           00679                 btfsc   mode, 2
0167   2???           00680                 call    thermometer
                      00681 
0168   2???           00682                 goto    voltmeterInit
                      00683 
                      00684 
                      00685 ; funzione di arrotondamento a 3 cifre dopo a virgola
0169                  00686 rounding
0169   ???? ????      00687                 banksel num1
016B   01??           00688                 clrf    sum
016C   01??           00689                 clrf    sum+1
                      00690 
016D   1003           00691                 bcf             STATUS, C
Message[305]: Using default destination of 1 (file).
016E   0D??           00692                 rlf             hdrthd
Message[305]: Using default destination of 1 (file).
016F   0D??           00693                 rlf             tensOfThousands
Message[305]: Using default destination of 1 (file).
0170   0D??           00694                 rlf             milions
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00695 
Message[305]: Using default destination of 1 (file).
0171   0D??           00696                 rlf             hdrthd
Message[305]: Using default destination of 1 (file).
0172   0D??           00697                 rlf             tensOfThousands
Message[305]: Using default destination of 1 (file).
0173   0D??           00698                 rlf             milions
                      00699 
Message[305]: Using default destination of 1 (file).
0174   0D??           00700                 rlf             hdrthd
Message[305]: Using default destination of 1 (file).
0175   0D??           00701                 rlf             tensOfThousands
Message[305]: Using default destination of 1 (file).
0176   0D??           00702                 rlf             milions
                      00703 
Message[305]: Using default destination of 1 (file).
0177   0D??           00704                 rlf             hdrthd
Message[305]: Using default destination of 1 (file).
0178   0D??           00705                 rlf             tensOfThousands
Message[305]: Using default destination of 1 (file).
0179   0D??           00706                 rlf             milions
                      00707 
                      00708                 ; risultato temporaneo in tensOfThousand e milions
                      00709                 
017A   08??           00710                 movfw   tensOfThousands
017B   00??           00711                 movwf   num1+1
017C   08??           00712                 movfw   milions
017D   00??           00713                 movwf   num1
                      00714 
017E   3000           00715                 movlw   0x00
017F   00??           00716                 movwf   num2
0180   3001           00717                 movlw   0x01                    ; incrementa di uno
0181   00??           00718                 movwf   num2+1
                      00719 
0182   1003           00720                 bcf             STATUS, C
0183   07??           00721                 addwf   num1+1, W               ; (num1+1)+(num2+1) parti meno significative
                      00722                 
0184   00??           00723                 movwf   number
0185   2???           00724                 call    daa
                      00725 
                      00726                 ; store ls bcd byte
                      00727                 ;movfw  number
0186   00??           00728                 movwf   sum+1
                      00729 
0187   08??           00730                 movfw   num1
                      00731 
0188   1803           00732                 btfsc   STATUS, C
0189   3E01           00733                 addlw   1                               ; Add one for carry
                      00734                 
018A   07??           00735                 addwf   num2, W 
                      00736                 
018B   00??           00737                 movwf   number
018C   2???           00738                 call    daa
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00739 
018D   00??           00740                 movwf   sum
                      00741 
                      00742                 ; print
018E   08??           00743                 movfw   sum
018F   0E??           00744                 swapf   sum, W
0190   390F           00745                 andlw   00001111B
0191   3E30           00746                 addlw   48
0192   2???           00747                 call    lcdWrite
                      00748 
0193   302E           00749                 movlw   '.'
0194   2???           00750                 call    lcdWrite
                      00751                 
0195   08??           00752                 movfw   sum
0196   390F           00753                 andlw   00001111B
0197   3E30           00754                 addlw   48
0198   2???           00755                 call    lcdWrite
                      00756                 
0199   08??           00757                 movfw   sum+1
019A   0E??           00758                 swapf   sum+1, W
019B   390F           00759                 andlw   00001111B
019C   3E30           00760                 addlw   48
019D   2???           00761                 call    lcdWrite
                      00762 
019E   08??           00763                 movfw   sum+1
019F   390F           00764                 andlw   00001111B
01A0   3E30           00765                 addlw   48
01A1   2???           00766                 call    lcdWrite
                      00767                 
01A2   2???           00768                 goto    checkButton2
                      00769 
                      00770 
                      00771 
                      00772 
                      00773 
                      00774 ; *****************************************
                      00775 ; ******************************************
                      00776                 
                      00777                 
                      00778 
                      00779 
                      00780 ; A/D Converter Initialization
                      00781 ;
                      00782 ; Preset values:  
                      00783 ; clock rate 4Mhz/32, 
                      00784 ; Vref+=Vdd Vref-=GND, right justified, all analog inputs
01A3                  00785 convInit
01A3   3081           00786         movlw   10000001B                                                       ; 4Mhz/32, channel 0, go
                            /!done=0, adon = 1
01A4   1283 1303      00787         banksel ADCON0
01A6   009F           00788         movwf   ADCON0
01A7   3080           00789         movlw   10000000B                                                       ; ADFM = 1 (right justif
                            ied), all analog inputs, Vref+=Vdd Vref-=Vss
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01A8   1683 1303      00790         banksel ADCON1
01AA   009F           00791         movwf   ADCON1
01AB   1283 1303      00792         banksel PIR1
                      00793 
                      00794         ; for using with interrupts
                      00795         ;bcf            PIR1, ADIF                                              ; A/D converter interrup
                            t flag bit to zero
                      00796         ;bsf    INTCON, GIE
                      00797         ;bsf            INTCON, PEIE
                      00798         ;banksel PIE1
                      00799         ;bsf            PIE1, ADIE
01AD   0008           00800         return
                      00801         
                      00802 
                      00803 
                      00804 ; -------------------------------------------------------------------------     ;
                      00805 ;                                        Binary to BCD conversion subroutine                            
                                    ;
                      00806 ; -------------------------------------------------------------------------     ;
                      00807 
01AE                  00808 bin2bcd
01AE   01??           00809         clrf    untten
01AF   01??           00810         clrf    hdrthd
01B0   01??           00811         clrf    tensOfThousands
01B1   01??           00812         clrf    milions
                      00813 
01B2   3018           00814         movlw   24                                      ; N iterations where N is bits number
01B3   00??           00815         movwf   count
                      00816 
01B4                  00817 lshift
01B4   2???           00818         call    leftShift                       ; rotate both bytes to left
01B5   0B??           00819         decfsz  count, 1                        ; counter
01B6   2???           00820         goto    adjNibbles                      ;
01B7   0008           00821         return                                          ; result is in 'untten' and 'hdrthd'
                      00822 
                      00823 
                      00824 
                      00825 ; sum 3 to all nibble, check ms bits. If msb is high update nibbles with result, 
                      00826 ; otherwise discard the result
01B8                  00827 adjNibbles
                      00828         ; adjust byte containing unities and tens
01B8   08??           00829         movfw   untten
01B9   3E03           00830         addlw   0x03
01BA   00??           00831         movwf   temp                                                    ; bit test on WREG is not allowe
                            d
01BB   1980           00832         btfsc   temp, 3
01BC   00??           00833         movwf   untten
                      00834         
01BD   08??           00835         movfw   untten                                                  ; restore
01BE   3E30           00836         addlw   0x30
01BF   00??           00837         movwf   temp
01C0   1B80           00838         btfsc   temp, 7
01C1   00??           00839         movwf   untten
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00840 
                      00841         ; adjust byte containing hundreds and thousands
01C2   08??           00842         movfw   hdrthd
01C3   3E03           00843         addlw   0x03
01C4   00??           00844         movwf   temp
01C5   1980           00845         btfsc   temp, 3
01C6   00??           00846         movwf   hdrthd
                      00847         
01C7   08??           00848         movfw   hdrthd                                                  ; restore
01C8   3E30           00849         addlw   0x30
01C9   00??           00850         movwf   temp
01CA   1B80           00851         btfsc   temp, 7
01CB   00??           00852         movwf   hdrthd
                      00853 
                      00854         ; adjust byte containing tens of thousands
01CC   08??           00855         movfw   tensOfThousands
01CD   3E03           00856         addlw   0x03
01CE   00??           00857         movwf   temp
01CF   1980           00858         btfsc   temp, 3
01D0   00??           00859         movwf   tensOfThousands
                      00860         
                      00861         ; 
01D1   08??           00862         movfw   tensOfThousands                                 ; restore
01D2   3E30           00863         addlw   0x30
01D3   00??           00864         movwf   temp
01D4   1B80           00865         btfsc   temp, 7
01D5   00??           00866         movwf   tensOfThousands
                      00867 
                      00868         ;
01D6   08??           00869         movfw   milions
01D7   3E03           00870         addlw   0x03
01D8   00??           00871         movwf   temp
01D9   1980           00872         btfsc   temp, 3
01DA   00??           00873         movwf   milions
                      00874         
01DB   08??           00875         movfw   milions                                                 ; restore
01DC   3E30           00876         addlw   0x30
01DD   00??           00877         movwf   temp
01DE   1B80           00878         btfsc   temp, 7
01DF   00??           00879         movwf   milions
                      00880         
                      00881 
                      00882         ; both bytes is ok, let's continue with the next shift
01E0   2???           00883         goto    lshift  
                      00884 
01E1                  00885 leftShift
01E1   1003           00886         bcf             STATUS, C                                               ; 'cause rotation is thr
                            ough the carry bit
01E2   0D??           00887         rlf             binvalue+2, 1
01E3   0D??           00888         rlf             binvalue+1, 1
01E4   0D??           00889         rlf             binvalue, 1                                             ; most significant bit i
                            s now the carry bit
01E5   0D??           00890         rlf             untten, 1       
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01E6   0D??           00891         rlf             hdrthd, 1
01E7   0D??           00892         rlf             tensOfThousands, 1
01E8   0D??           00893         rlf             milions, 1
01E9   0008           00894         return
                      00895 
                      00896 
                      00897 
01EA                  00898 sw2voltmeter                                                            ; switch to Voltmeter putting th
                            e TC74 in standby mode
01EA   2???           00899                 call    tc74StandBy
01EB   2???           00900                 call    voltmeter
                      00901 
                      00902 
                      00903 
                      00904 ; -------------------------------------------------------------------------     ;
                      00905 ; Decimal adjust accumulator. Use after a bcd addition                                          ;
                      00906 ; -------------------------------------------------------------------------     ;
                      00907 
01EC                  00908 daa             ; decimal adjust accumulator (after addition)
01EC   1000           00909                 BCF     adjflag, 0
01ED   1803           00910                 BTFSC   STATUS, C
01EE   1400           00911                 BSF     adjflag, 0
01EF   3006           00912                 MOVLW   06h
01F0   1883           00913                 BTFSC   STATUS, DC
01F1   07??           00914                 ADDWF   number, f
01F2   07??           00915                 ADDWF   number, f
01F3   1C83           00916                 BTFSS   STATUS, DC
01F4   02??           00917                 SUBWF   number, F
01F5   3060           00918                 MOVLW   60h
01F6   07??           00919                 ADDWF   number, F
01F7   1C03           00920                 BTFSS   STATUS, C
01F8   1800           00921                 BTFSC   adjflag, 0
01F9   2???           00922                 goto    setCarry
01FA   02??           00923                 subwf   number, F
01FB   1003           00924                 bcf             STATUS, C
                      00925                 
01FC   08??           00926                 movfw   number
01FD   0008           00927                 return
                      00928 
01FE                  00929 setCarry
01FE   1403           00930                 bsf             STATUS, C
01FF   08??           00931                 movfw   number
0200   0008           00932                 return
                      00933 
3D31                  00934                 END                                                                     ; directive 'end
                             of program'
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BRGH                              00000002
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CIS                               00000003
CKE                               00000006
CKP                               00000004
CM0                               00000000
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

CM1                               00000001
CM2                               00000002
CMCON                             0000009C
CMIE                              00000006
CMIF                              00000006
CREN                              00000004
CSRC                              00000007
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            0000009D
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
D_A                               00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EN                                6
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RBIE                              00000003
RBIF                              00000000
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
RP0                               00000005
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_W                               00000002
S                                 00000003
SEN                               00000000
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
STATUS                            00000003
SW1                               00000000
SW2                               00000004
SW_STATUS                         00000006
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TC74ADD_R                         0000009B
TC74ADD_W                         0000009A
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISB                             00000086
TRISC                             00000087
TRISD                             00000088
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00001FFF
_CP_OFF                           00003FFF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_HS_OSC                           00003FFE
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_MAIN_004A                        0000004A
_MAIN_0062                        00000062
_MAIN_0067                        00000067
_MAIN_0078                        00000078
_MAIN_00B8                        000000B8
_MAIN_00C4                        000000C4
_MAIN_00C8                        000000C8
_MAIN_00CE                        000000CE
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

_MAIN_00E6                        000000E6
_MAIN_00EA                        000000EA
_MAIN_0101                        00000101
_MAIN_0106                        00000106
_MAIN_010C                        0000010C
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_1FOURTH                      00003BFF
_WRT_256                          00003DFF
_WRT_HALF                         000039FF
_WRT_OFF                          00003FFF
_XT_OSC                           00003FFD
__16F877A                         00000001
adjNibbles                        000001B8
adjflag                           00000014
bin2bcd                           000001AE
binvalue                          00000004
char                              00000001
checkButton2                      00000162
cmd_byte                          0000000E
convInit                          000001A3
convert_temp                      0000008A
count                             00000000
count1                            00000000
daa                               000001EC
delayCount                        0000000F
delayLoop                         00000000
flag                              00000000
getTemp                           00000073
hdrthd                            00000008
hex2ascii                         00000000
hundreds                          0000009E
i2cIdle                           00000103
index                             000000F2
indietro                          0000000E
lcdClear                          00000000
lcdInit                           00000000
lcdRxShift                        00000000
lcdWrite                          00000000
leftShift                         000001E1
lshift                            000001B4
mainLoop                          0000002C
menu                              0000001E
milions                           0000000A
mode                              0000000F
mul13x10                          00000000
num1                              00000010
num2                              00000012
number                            00000017
point2Char                        00000002
MPASM  5.35                          MAIN.ASM   6-12-2010  23:04:40         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

printString                       00000000
readByte                          000000BB
resconv                           00000004
return2home                       00000000
rounding                          00000169
setCarry                          000001FE
setXAddress                       00000000
skipShifts                        00000015
start                             00000000
stat_temp                         00000001
sum                               00000015
sw2voltmeter                      000001EA
tc74Init                          000000D0
tc74StandBy                       000000E2
tcStandBy                         000000E8
temp                              0000000B
temp3                             00000003
tensAndUnits                      000000A9
tensOfThousands                   00000009
text1                             00000020
text2                             0000002B
text6                             00000039
textMenu1                         0000006D
textMenu2                         0000007C
thermometer                       0000003B
twoComplement                     000000B1
untten                            00000007
var                               00000001
var2                              00000002
voltmeter                         0000010E
voltmeterInit                     00000113
w_temp                            00000000
wait                              00000000
waitAck                           000000B4
waitBusyFlag                      00000000
waitEOC                           0000011F

Errors   :     0
Warnings :     1 reported,     0 suppressed
Messages :    12 reported,    35 suppressed

